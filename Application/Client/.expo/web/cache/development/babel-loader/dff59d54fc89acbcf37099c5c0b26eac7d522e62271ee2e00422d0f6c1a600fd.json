{"ast":null,"code":"import _asyncToGenerator from \"@babel/runtime/helpers/asyncToGenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\nimport React, { useState, useContext } from 'react';\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport ShowAvatar from \"../Avatar/ShowAvatar/showAvatar\";\nimport ForwardSvg from \"../../assets/icons/forwardSvg\";\nimport ForwardFocusSvg from \"../../assets/icons/forwardFocusSvg\";\nimport { MessageContext } from \"../../context/MessageContext\";\nimport AuthContext from \"../../context/AuthContext\";\nimport useStyles from \"./messageBody.module\";\nimport { jsx as _jsx } from \"react/jsx-runtime\";\nimport { jsxs as _jsxs } from \"react/jsx-runtime\";\nvar MessageBody = function MessageBody(_ref) {\n  var data = _ref.data,\n    currentUser = _ref.currentUser;\n  var imageUrl = data.imageUrl,\n    nickname = data.nickname,\n    role = data.role,\n    message = data.message,\n    own = data.own,\n    channel = data.channel,\n    date = data.date,\n    unauth = data.unauth,\n    ident = data.ident;\n  var _useState = useState(false),\n    _useState2 = _slicedToArray(_useState, 2),\n    isFocused = _useState2[0],\n    setIsFocused = _useState2[1];\n  var dated = new Date(date);\n  var time = dated.toLocaleTimeString([], {\n    hour: '2-digit',\n    minute: '2-digit'\n  });\n  var username = 'admin';\n  var password = 'root';\n  var _useContext = useContext(AuthContext),\n    user = _useContext.user;\n  var styles = useStyles();\n  var forwardIcon = isFocused ? _jsx(ForwardFocusSvg, {}) : _jsx(ForwardSvg, {});\n  var messageBoxStyles = [styles.messageBox, own ? styles.ownMessageBox : styles.box, {\n    borderTopRightRadius: own ? 10 : 10,\n    borderBottomRightRadius: own ? 0 : 10,\n    borderBottomLeftRadius: own ? 10 : 10,\n    borderTopLeftRadius: own ? 10 : 0\n  }];\n  var handleForwardPress = function () {\n    var _ref2 = _asyncToGenerator(function* () {\n      setIsFocused(function (prevIsFocused) {\n        return !prevIsFocused;\n      });\n      if (isFocused) {\n        var user_id = user.id;\n        var message_id = ident;\n        try {\n          var response = yield fetch(\"https://linking-api.onrender.com/api/saved_message/delete?user_id=\" + user_id + \"&message_id=\" + message_id, {\n            method: 'DELETE',\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': \"Basic \" + btoa(username + \":\" + password)\n            }\n          });\n          if (response.ok) {} else {\n            alert('Не удалось удалить сообщение');\n          }\n        } catch (error) {\n          console.log('Ошибка при удалении сообщения', error);\n        }\n      } else {\n        var body = {\n          username: user.name,\n          messageId: ident\n        };\n        try {\n          var _response = yield fetch('https://linking-api.onrender.com/api/saved_message/save', {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json',\n              'Authorization': \"Basic \" + btoa(username + \":\" + password)\n            },\n            body: JSON.stringify(body)\n          });\n          if (_response.ok) {} else {\n            alert('Не удалось сохранить сообщение');\n          }\n        } catch (error) {\n          console.log('Ошибка при сохранении сообщения', error);\n        }\n      }\n    });\n    return function handleForwardPress() {\n      return _ref2.apply(this, arguments);\n    };\n  }();\n  return _jsxs(View, {\n    style: own ? styles.ownContainer : styles.container,\n    children: [!own && imageUrl && _jsx(View, {\n      style: styles.avatar,\n      children: _jsx(ShowAvatar, {\n        imageUrl: imageUrl,\n        profile: false\n      })\n    }), _jsxs(View, {\n      style: messageBoxStyles,\n      children: [!unauth && _jsx(TouchableOpacity, {\n        onPress: handleForwardPress,\n        children: _jsx(View, {\n          style: own ? styles.ownForward : styles.forward,\n          children: forwardIcon\n        })\n      }), _jsx(Text, {\n        style: styles.nickname,\n        children: nickname\n      }), channel && _jsx(Text, {\n        style: styles.role,\n        children: role\n      }), _jsx(Text, {\n        style: styles.message,\n        children: message\n      }), _jsx(Text, {\n        style: own ? styles.ownTime : styles.time,\n        children: time\n      }), own && _jsx(View, {\n        style: styles.ownBubbleTail\n      }), !own && _jsx(View, {\n        style: styles.bubbleTail\n      })]\n    })]\n  });\n};\nexport default MessageBody;","map":{"version":3,"names":["React","useState","useContext","View","Text","StyleSheet","TouchableOpacity","ShowAvatar","ForwardSvg","ForwardFocusSvg","MessageContext","AuthContext","useStyles","jsx","_jsx","jsxs","_jsxs","MessageBody","_ref","data","currentUser","imageUrl","nickname","role","message","own","channel","date","unauth","ident","_useState","_useState2","_slicedToArray","isFocused","setIsFocused","dated","Date","time","toLocaleTimeString","hour","minute","username","password","_useContext","user","styles","forwardIcon","messageBoxStyles","messageBox","ownMessageBox","box","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","borderTopLeftRadius","handleForwardPress","_ref2","_asyncToGenerator","prevIsFocused","user_id","id","message_id","response","fetch","method","headers","btoa","ok","alert","error","console","log","body","name","messageId","JSON","stringify","apply","arguments","style","ownContainer","container","children","avatar","profile","onPress","ownForward","forward","ownTime","ownBubbleTail","bubbleTail"],"sources":["C:/Users/ilias/OneDrive/Рабочий стол/messenger_project/Application/Client/components/messageBody/messageBody.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity } from 'react-native-web';\r\nimport ShowAvatar from '../Avatar/ShowAvatar/showAvatar';\r\nimport ForwardSvg from '../../assets/icons/forwardSvg';\r\nimport ForwardFocusSvg from '../../assets/icons/forwardFocusSvg';\r\nimport { MessageContext } from '../../context/MessageContext';\r\nimport AuthContext from '../../context/AuthContext';\r\nimport useStyles from './messageBody.module';\r\n\r\nconst MessageBody = ({ data, currentUser }) => {\r\n  const { imageUrl, nickname, role, message, own, channel, date, unauth, ident  } = data;\r\n  const [isFocused, setIsFocused] = useState(false);\r\n  const dated = new Date(date);\r\n  const time = dated.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n  const username = 'admin';\r\n  const password = 'root';\r\n  const {user} = useContext(AuthContext);\r\n  const styles = useStyles();\r\n  const forwardIcon = isFocused ? <ForwardFocusSvg /> : <ForwardSvg />;\r\n\r\n  const messageBoxStyles = [\r\n    styles.messageBox,\r\n    own ? styles.ownMessageBox : styles.box,\r\n    {\r\n      borderTopRightRadius: own ? 10 : 10,\r\n      borderBottomRightRadius: own ? 0 : 10,\r\n      borderBottomLeftRadius: own ? 10 : 10,\r\n      borderTopLeftRadius: own ? 10 : 0,\r\n    },\r\n  ];\r\n\r\n  const handleForwardPress = async () => {\r\n    setIsFocused((prevIsFocused) => !prevIsFocused);\r\n    if (isFocused) {\r\n      const user_id = user.id;\r\n      const message_id = ident;\r\n  \r\n      try {\r\n        const response = await fetch(`https://linking-api.onrender.com/api/saved_message/delete?user_id=${user_id}&message_id=${message_id}`, {\r\n          method: 'DELETE',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Basic ${btoa(`${username}:${password}`)}`\r\n          },\r\n        });\r\n  \r\n        if (response.ok) {\r\n         \r\n        } else {\r\n          alert('Не удалось удалить сообщение');\r\n        }\r\n      } catch (error) {\r\n        console.log('Ошибка при удалении сообщения', error);\r\n      }\r\n    } else {\r\n      const body = {\r\n        username: user.name,\r\n        messageId: ident\r\n      };\r\n  \r\n      try {\r\n        const response = await fetch('https://linking-api.onrender.com/api/saved_message/save', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Basic ${btoa(`${username}:${password}`)}`,\r\n          },\r\n          body: JSON.stringify(body),\r\n        });\r\n  \r\n        if (response.ok) {\r\n          // Handle successful save\r\n        } else {\r\n          alert('Не удалось сохранить сообщение');\r\n        }\r\n      } catch (error) {\r\n        console.log('Ошибка при сохранении сообщения', error);\r\n      }\r\n    }\r\n  \r\n    \r\n  };\r\n  \r\n\r\n  return (\r\n    <View style={own ? styles.ownContainer : styles.container}>\r\n      {!own && imageUrl && (\r\n        <View style={styles.avatar}>\r\n          <ShowAvatar imageUrl={imageUrl} profile={false} />\r\n        </View>\r\n      )}\r\n      <View style={messageBoxStyles}>\r\n        {!unauth && (\r\n          <TouchableOpacity onPress={handleForwardPress}>\r\n            <View style={own ? styles.ownForward : styles.forward}>{forwardIcon}</View>\r\n          </TouchableOpacity>\r\n        )}\r\n        <Text style={styles.nickname}>{nickname}</Text>\r\n        {channel && <Text style={styles.role}>{role}</Text>}\r\n        <Text style={styles.message}>{message}</Text>\r\n        <Text style={own ? styles.ownTime : styles.time}>{time}</Text>\r\n        {own && <View style={styles.ownBubbleTail} />}\r\n        {!own && <View style={styles.bubbleTail} />}\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\n\r\n\r\nexport default MessageBody;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}