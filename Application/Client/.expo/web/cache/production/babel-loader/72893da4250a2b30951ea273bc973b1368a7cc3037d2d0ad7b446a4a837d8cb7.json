{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useState,useRef}from'react';import View from\"react-native-web/dist/exports/View\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import TextInput from\"react-native-web/dist/exports/TextInput\";import useStyles from\"./messageInput.module\";import SendSvg from\"../../../assets/icons/sendSvg\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MessageInput=function MessageInput(_ref){var curuser=_ref.curuser,chanInf=_ref.chanInf,channel=_ref.channel,onMessageSent=_ref.onMessageSent;var _useState=useState(''),_useState2=_slicedToArray(_useState,2),message=_useState2[0],setMessage=_useState2[1];var styles=useStyles();var username='admin';var password='root';var inputRef=useRef(null);var handleSend=function(){var _ref2=_asyncToGenerator(function*(){if(message){try{if(channel){var requestBody={currentUsername:curuser,message:message,channelName:chanInf.channel.name};setMessage('');var response=yield fetch('https://linking-api.onrender.com/api/channels/add_message',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Basic \"+btoa(username+\":\"+password)},body:JSON.stringify(requestBody)});if(response.ok){onMessageSent();}else{alert('Не удалось отправить сообщение');}}else{var _requestBody={currentUsername:curuser,otherUsername:chanInf,message:message};setMessage('');var _response=yield fetch('https://linking-api.onrender.com/api/chats/add_message',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Basic \"+btoa(username+\":\"+password)},body:JSON.stringify(_requestBody)});if(_response.ok){onMessageSent();}else{alert('Не удалось отправить сообщение');}}}catch(error){alert('Ошибка отправки',error);}}});return function handleSend(){return _ref2.apply(this,arguments);};}();var handleKeyPress=function handleKeyPress(event){if(event.key==='Enter'&&!event.shiftKey){event.preventDefault();handleSend();}};return _jsxs(View,{style:styles.container,children:[_jsx(TextInput,{ref:inputRef,style:styles.input,placeholder:\"\\u0421\\u043E\\u043E\\u0431\\u0449\\u0435\\u043D\\u0438\\u0435\",value:message,onChangeText:setMessage,multiline:true,numberOfLines:4,onKeyPress:handleKeyPress}),_jsx(TouchableOpacity,{style:styles.sendButton,onPress:handleSend,children:_jsx(SendSvg,{})})]});};export default MessageInput;","map":{"version":3,"names":["React","useState","useRef","View","TouchableOpacity","TextInput","useStyles","SendSvg","jsx","_jsx","jsxs","_jsxs","MessageInput","_ref","curuser","chanInf","channel","onMessageSent","_useState","_useState2","_slicedToArray","message","setMessage","styles","username","password","inputRef","handleSend","_ref2","_asyncToGenerator","requestBody","currentUsername","channelName","name","response","fetch","method","headers","btoa","body","JSON","stringify","ok","alert","otherUsername","error","apply","arguments","handleKeyPress","event","key","shiftKey","preventDefault","style","container","children","ref","input","placeholder","value","onChangeText","multiline","numberOfLines","onKeyPress","sendButton","onPress"],"sources":["C:/Users/ilias/OneDrive/Рабочий стол/messenger_project/Application/Client/components/inputs/messageInput/messageInput.js"],"sourcesContent":["import React, { useState, useRef } from 'react';\r\nimport { View, TouchableOpacity, TextInput } from 'react-native-web';\r\nimport useStyles from './messageInput.module';\r\nimport SendSvg from '../../../assets/icons/sendSvg';\r\n\r\nconst MessageInput = ({ curuser, chanInf, channel, onMessageSent }) => {\r\n  const [message, setMessage] = useState('');\r\n  const styles = useStyles();\r\n  const username = 'admin';\r\n  const password = 'root';\r\n  const inputRef = useRef(null); \r\n  \r\n  const handleSend = async () => {\r\n    if (message) {\r\n      try {\r\n        if (channel) {\r\n        \r\n          const requestBody = {\r\n            currentUsername: curuser,\r\n            message: message,\r\n            channelName: chanInf.channel.name,\r\n          };\r\n          setMessage('');\r\n          const response = await fetch('https://linking-api.onrender.com/api/channels/add_message', {\r\n            method: 'POST',\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              'Authorization': `Basic ${btoa(`${username}:${password}`)}`,\r\n            },\r\n            body: JSON.stringify(requestBody),\r\n          });\r\n    \r\n          if (response.ok) {\r\n            onMessageSent(); \r\n          } else {\r\n            alert('Не удалось отправить сообщение');\r\n          }\r\n        } else {\r\n          \r\n          const requestBody = {\r\n            currentUsername: curuser,\r\n            otherUsername: chanInf,\r\n            message: message,\r\n          };\r\n          setMessage('');\r\n          const response = await fetch('https://linking-api.onrender.com/api/chats/add_message', {\r\n            method: 'POST',\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              'Authorization': `Basic ${btoa(`${username}:${password}`)}`,\r\n            },\r\n            body: JSON.stringify(requestBody),\r\n          });\r\n    \r\n          if (response.ok) {\r\n            onMessageSent();\r\n          } else {\r\n            alert('Не удалось отправить сообщение');\r\n          }\r\n        }\r\n      } catch (error) {\r\n        alert('Ошибка отправки', error);\r\n      }\r\n    }\r\n  };\r\n  \r\n  const handleKeyPress = (event) => {\r\n    if (event.key === 'Enter' && !event.shiftKey) {\r\n      event.preventDefault();\r\n      handleSend();\r\n    }\r\n  };\r\n\r\n  return (\r\n    <View style={styles.container}>\r\n      <TextInput\r\n        ref={inputRef}\r\n        style={styles.input}\r\n        placeholder=\"Сообщение\"\r\n        value={message}\r\n        onChangeText={setMessage}\r\n        multiline\r\n        numberOfLines={4}\r\n        onKeyPress={handleKeyPress}\r\n      />\r\n      <TouchableOpacity style={styles.sendButton} onPress={handleSend}>\r\n        <SendSvg />\r\n      </TouchableOpacity>\r\n    </View>\r\n  );\r\n};\r\n\r\nexport default MessageInput;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}