{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{createContext,useEffect,useState,useContext}from'react';import AsyncStorage from'@react-native-async-storage/async-storage';import{ImageContext}from\"./ImageContext\";import{useNavigation}from'@react-navigation/native';import{jsx as _jsx}from\"react/jsx-runtime\";var AuthContext=createContext();export var AuthProvider=function AuthProvider(_ref){var children=_ref.children;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isLoggedIn=_useState2[0],setIsLoggedIn=_useState2[1];var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),user=_useState4[0],setUser=_useState4[1];var _useContext=useContext(ImageContext),updateSelectedImage=_useContext.updateSelectedImage;useEffect(function(){checkLoginStatus();},[]);var checkLoginStatus=function(){var _ref2=_asyncToGenerator(function*(){try{var isLoggedInValue=yield AsyncStorage.getItem('isLoggedIn');var userData=yield AsyncStorage.getItem('user');if(isLoggedInValue==='true'&&userData){setIsLoggedIn(true);setUser(JSON.parse(userData));}}catch(error){console.error('Ошибка при проверке статуса пользователя:',error);}});return function checkLoginStatus(){return _ref2.apply(this,arguments);};}();var login=function(){var _ref3=_asyncToGenerator(function*(userData){setIsLoggedIn(true);setUser(userData);try{yield AsyncStorage.clear();yield AsyncStorage.setItem('isLoggedIn','true');yield AsyncStorage.setItem('user',JSON.stringify(userData));}catch(error){console.error('Ошибкра при входе:',error);}});return function login(_x){return _ref3.apply(this,arguments);};}();var logout=function(){var _ref4=_asyncToGenerator(function*(){setIsLoggedIn(false);setUser(null);updateSelectedImage(null);try{yield AsyncStorage.removeItem('isLoggedIn');yield AsyncStorage.removeItem('user');}catch(error){console.error('Ошибка при выходе:',error);}});return function logout(){return _ref4.apply(this,arguments);};}();var updateUser=function updateUser(updatedUser){setUser(updatedUser);};var authContextValue={isLoggedIn:isLoggedIn,user:user,login:login,logout:logout,updateUser:updateUser};return _jsx(AuthContext.Provider,{value:authContextValue,children:children});};export default AuthContext;","map":{"version":3,"names":["React","createContext","useEffect","useState","useContext","AsyncStorage","ImageContext","useNavigation","jsx","_jsx","AuthContext","AuthProvider","_ref","children","_useState","_useState2","_slicedToArray","isLoggedIn","setIsLoggedIn","_useState3","_useState4","user","setUser","_useContext","updateSelectedImage","checkLoginStatus","_ref2","_asyncToGenerator","isLoggedInValue","getItem","userData","JSON","parse","error","console","apply","arguments","login","_ref3","clear","setItem","stringify","_x","logout","_ref4","removeItem","updateUser","updatedUser","authContextValue","Provider","value"],"sources":["C:/Users/ilias/OneDrive/Рабочий стол/test/context/AuthContext.js"],"sourcesContent":["import React, { createContext, useEffect, useState, useContext } from 'react';\r\nimport AsyncStorage from '@react-native-async-storage/async-storage';\r\nimport { ImageContext } from './ImageContext';\r\nimport { useNavigation } from '@react-navigation/native';\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n  const [isLoggedIn, setIsLoggedIn] = useState(false);\r\n  const [user, setUser] = useState(null);\r\n  const { updateSelectedImage } = useContext(ImageContext);\r\n \r\n  useEffect(() => {\r\n    checkLoginStatus();\r\n  }, []);\r\n\r\n  const checkLoginStatus = async () => {\r\n    try {\r\n      const isLoggedInValue = await AsyncStorage.getItem('isLoggedIn');\r\n      const userData = await AsyncStorage.getItem('user');\r\n      if (isLoggedInValue === 'true' && userData) {\r\n        setIsLoggedIn(true);\r\n        setUser(JSON.parse(userData));\r\n      }\r\n    } catch (error) {\r\n      console.error('Ошибка при проверке статуса пользователя:', error);\r\n    }\r\n  };\r\n\r\n  const login = async (userData) => {\r\n    setIsLoggedIn(true);\r\n    setUser(userData);\r\n    try {\r\n      await AsyncStorage.clear(); \r\n      await AsyncStorage.setItem('isLoggedIn', 'true');\r\n      await AsyncStorage.setItem('user', JSON.stringify(userData));\r\n    } catch (error) {\r\n      console.error('Ошибкра при входе:', error);\r\n    }\r\n  };\r\n\r\n  const logout = async () => {\r\n    setIsLoggedIn(false);\r\n    setUser(null);\r\n    updateSelectedImage(null); \r\n    try {\r\n      await AsyncStorage.removeItem('isLoggedIn');\r\n      await AsyncStorage.removeItem('user');\r\n   \r\n    } catch (error) {\r\n      console.error('Ошибка при выходе:', error);\r\n    }\r\n  };\r\n\r\n  const updateUser = (updatedUser) => {\r\n    setUser(updatedUser);\r\n  };\r\n\r\n  const authContextValue = {\r\n    isLoggedIn,\r\n    user,\r\n    login,\r\n    logout,\r\n    updateUser\r\n  };\r\n\r\n  return (\r\n    <AuthContext.Provider value={authContextValue}>\r\n      {children}\r\n    </AuthContext.Provider>\r\n  );\r\n};\r\n\r\nexport default AuthContext;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}