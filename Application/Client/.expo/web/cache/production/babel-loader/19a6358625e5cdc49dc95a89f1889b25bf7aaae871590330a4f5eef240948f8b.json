{"ast":null,"code":"import _defineProperty from\"@babel/runtime/helpers/defineProperty\";import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter(function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable;})),keys.push.apply(keys,symbols);}return keys;}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach(function(key){_defineProperty(target,key,source[key]);}):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach(function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key));});}return target;}import React,{useState}from\"react\";import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import Modal from\"react-native-web/dist/exports/Modal\";import ChangeSvg from\"../../assets/icons/changeSvg\";import DeleteSvg from\"../../assets/icons/deleteSvg\";import AdminSvg from\"../../assets/icons/adminSvg\";import AdminFocusSvg from\"../../assets/icons/adminFocusSvg\";import HeaderButton from\"../buttons/headerButton\";import DataInput from\"../inputs/textInput/textInput\";import axios from'axios';import useStyles from\"./settingsBody.module\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function SettingsBody(_ref){var data=_ref.data;var role=data.role,name=data.name,onPress=data.onPress,containerStyle=data.containerStyle,creator=data.creator,channelId=data.channelId;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isHovered=_useState2[0],setIsHovered=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),showPopup=_useState4[0],setShowPopup=_useState4[1];var _useState5=useState({nickname:'',role:role}),_useState6=_slicedToArray(_useState5,2),inputText=_useState6[0],setInputText=_useState6[1];var styles=useStyles();var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),isAdmin=_useState8[0],setIsAdmin=_useState8[1];var username='admin';var password='root';var isFormValid=inputText.role;var handleDelete=function(){var _ref2=_asyncToGenerator(function*(){try{var url=\"https://backend-web-service-test.onrender.com/api/channels/\"+channelId.channel.id+\"/leave?username=\"+name;var response=yield axios.delete(url,{auth:{username:username,password:password}});}catch(error){alert('Ошибка при попытки удаления пользователя:',error);}});return function handleDelete(){return _ref2.apply(this,arguments);};}();var handleAdminClick=function handleAdminClick(){setIsAdmin(!isAdmin);};var handleSaveChanges=function(){var _ref3=_asyncToGenerator(function*(){var url='https://backend-web-service-test.onrender.com/api/roles/update';var requestBody={name:inputText.role,isAdmin:isAdmin,username:name,channelName:channelId.channel.name};try{var response=yield fetch(url,{method:'PUT',headers:{'Content-Type':'application/json',Authorization:\"Basic \"+btoa(username+\":\"+password)},body:JSON.stringify(requestBody)});if(response.ok){}else{alert('Не удалось создать роль');}}catch(error){alert('Ошибка при создании роли',error);}setShowPopup(false);});return function handleSaveChanges(){return _ref3.apply(this,arguments);};}();return _jsxs(TouchableOpacity,{style:[styles.container,containerStyle,isHovered&&{backgroundColor:\"#E7DEDE\"}],onMouseEnter:function onMouseEnter(){return setIsHovered(true);},onMouseLeave:function onMouseLeave(){return setIsHovered(false);},children:[_jsxs(View,{style:styles.content,children:[!creator&&_jsx(TouchableOpacity,{onPress:handleDelete,children:_jsx(DeleteSvg,{})}),_jsx(Text,{style:styles.username,children:name}),_jsx(Text,{style:styles.role,children:inputText.role}),!creator&&_jsx(TouchableOpacity,{onPress:function onPress(){return setShowPopup(true);},children:_jsx(ChangeSvg,{})})]}),_jsx(Modal,{visible:showPopup,transparent:true,children:_jsxs(View,{style:styles.popupContainer,children:[_jsx(Text,{style:styles.text,children:\"\\u041D\\u0430\\u0437\\u0432\\u0430\\u043D\\u0438\\u0435 \\u0440\\u043E\\u043B\\u0438\"}),_jsxs(View,{style:styles.inputContainer,children:[_jsx(DataInput,{value:inputText.role,setValue:function setValue(text){return setInputText(_objectSpread(_objectSpread({},inputText),{},{role:text}));},placeholder:\"\",type:\"nickname\",flex:true}),_jsx(TouchableOpacity,{style:styles.adminButton,onPress:handleAdminClick,children:isAdmin?_jsx(AdminFocusSvg,{}):_jsx(AdminSvg,{})})]}),_jsx(View,{children:_jsx(TouchableOpacity,{onPress:function onPress(){return setShowPopup(false);},children:_jsx(HeaderButton,{title:\"Назначить\",onPress:handleSaveChanges,disabled:!isFormValid})})})]})})]});}","map":{"version":3,"names":["React","useState","View","Text","TouchableOpacity","Modal","ChangeSvg","DeleteSvg","AdminSvg","AdminFocusSvg","HeaderButton","DataInput","axios","useStyles","jsx","_jsx","jsxs","_jsxs","SettingsBody","_ref","data","role","name","onPress","containerStyle","creator","channelId","_useState","_useState2","_slicedToArray","isHovered","setIsHovered","_useState3","_useState4","showPopup","setShowPopup","_useState5","nickname","_useState6","inputText","setInputText","styles","_useState7","_useState8","isAdmin","setIsAdmin","username","password","isFormValid","handleDelete","_ref2","_asyncToGenerator","url","channel","id","response","delete","auth","error","alert","apply","arguments","handleAdminClick","handleSaveChanges","_ref3","requestBody","channelName","fetch","method","headers","Authorization","btoa","body","JSON","stringify","ok","style","container","backgroundColor","onMouseEnter","onMouseLeave","children","content","visible","transparent","popupContainer","text","inputContainer","value","setValue","_objectSpread","placeholder","type","flex","adminButton","title","disabled"],"sources":["C:/Users/ilias/OneDrive/Рабочий стол/test/components/settingsBody/settingsBody.js"],"sourcesContent":["import React, { useState } from \"react\";\r\nimport {\r\n    View,\r\n    Text,\r\n    TouchableOpacity,\r\n    Modal,\r\n} from \"react-native-web\";\r\nimport ChangeSvg from \"../../assets/icons/changeSvg\";\r\nimport DeleteSvg from \"../../assets/icons/deleteSvg\";\r\nimport AdminSvg from \"../../assets/icons/adminSvg\";\r\nimport AdminFocusSvg from \"../../assets/icons/adminFocusSvg\";\r\nimport HeaderButton from \"../buttons/headerButton\";\r\nimport DataInput from \"../inputs/textInput/textInput\";\r\nimport axios from 'axios';\r\nimport useStyles from \"./settingsBody.module\";\r\n\r\n\r\nexport default function SettingsBody({ data }) {\r\n    const { role, name, onPress, containerStyle, creator, channelId } = data;\r\n    const [isHovered, setIsHovered] = useState(false);\r\n    const [showPopup, setShowPopup] = useState(false);\r\n    const [inputText, setInputText] = useState({\r\n        nickname: '',\r\n        role: role, \r\n    });\r\n    const styles = useStyles();\r\n    const [isAdmin, setIsAdmin] = useState(false); \r\n    const username = 'admin';\r\n    const password = 'root';\r\n    const isFormValid = inputText.role;\r\n\r\n    const handleDelete = async () => {\r\n        try {\r\n          const url = `https://backend-web-service-test.onrender.com/api/channels/${channelId.channel.id}/leave?username=${name}`;\r\n          const response = await axios.delete(url, {\r\n            auth: {\r\n              username: username,\r\n              password: password\r\n            }\r\n          });\r\n        } catch (error) {\r\n          alert('Ошибка при попытки удаления пользователя:', error);\r\n        }\r\n      };\r\n\r\n    const handleAdminClick = () => {\r\n        setIsAdmin(!isAdmin);\r\n    };\r\n\r\n    const handleSaveChanges = async () => {\r\n        const url = 'https://backend-web-service-test.onrender.com/api/roles/update';\r\n      \r\n        const requestBody = {\r\n          name: inputText.role,\r\n          isAdmin: isAdmin,\r\n          username: name,\r\n          channelName: channelId.channel.name\r\n        };\r\n      \r\n        try {\r\n            \r\n          const response = await fetch(url, {\r\n            method: 'PUT',\r\n            headers: {\r\n              'Content-Type': 'application/json',\r\n              Authorization: `Basic ${btoa(`${username}:${password}`)}` \r\n            },\r\n            body: JSON.stringify(requestBody)\r\n          });\r\n          if (response.ok) {\r\n\r\n          } else {\r\n            alert('Не удалось создать роль');\r\n          }\r\n        } catch (error) {\r\n          alert('Ошибка при создании роли', error);\r\n        }\r\n        setShowPopup(false);\r\n      };\r\n      \r\n\r\n    return (\r\n        <TouchableOpacity\r\n            style={[\r\n                styles.container,\r\n                containerStyle,\r\n                isHovered && { backgroundColor: \"#E7DEDE\" },\r\n            ]}\r\n            onMouseEnter={() => setIsHovered(true)}\r\n            onMouseLeave={() => setIsHovered(false)}\r\n        >\r\n            <View style={styles.content}>\r\n                {!creator && (\r\n                    <TouchableOpacity onPress={handleDelete}>\r\n                        <DeleteSvg />\r\n                    </TouchableOpacity>\r\n                )}\r\n\r\n                <Text style={styles.username}>{name}</Text>\r\n                <Text style={styles.role}>{inputText.role}</Text>\r\n\r\n                {!creator  && (\r\n                    <TouchableOpacity onPress={() => setShowPopup(true)}>\r\n                        <ChangeSvg />\r\n                    </TouchableOpacity>\r\n                )}\r\n            </View>\r\n\r\n\r\n            <Modal visible={showPopup} transparent={true}>\r\n                <View style={styles.popupContainer}>\r\n                    <Text style={styles.text}>Название роли</Text>\r\n                    <View style={styles.inputContainer}>\r\n                        <DataInput\r\n                            value={inputText.role}\r\n                            setValue={(text) => setInputText({ ...inputText, role: text })}\r\n                            placeholder={\"\"}\r\n                            type={\"nickname\"}\r\n                            flex={true}\r\n                        />\r\n                        <TouchableOpacity style={styles.adminButton} onPress={handleAdminClick}>\r\n                            {isAdmin ? <AdminFocusSvg /> : <AdminSvg />}\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                    <View >\r\n                        <TouchableOpacity onPress={() => setShowPopup(false)}>\r\n                            <HeaderButton title={\"Назначить\"} onPress={handleSaveChanges} disabled={!isFormValid} />\r\n                        </TouchableOpacity>\r\n                    </View>\r\n                </View>\r\n            </Modal>\r\n        </TouchableOpacity>\r\n    );\r\n}\r\n\r\n\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}