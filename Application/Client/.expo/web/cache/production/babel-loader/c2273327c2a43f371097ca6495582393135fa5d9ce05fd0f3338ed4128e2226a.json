{"ast":null,"code":"import _asyncToGenerator from\"@babel/runtime/helpers/asyncToGenerator\";import _slicedToArray from\"@babel/runtime/helpers/slicedToArray\";import React,{useState,useContext}from'react';import View from\"react-native-web/dist/exports/View\";import Text from\"react-native-web/dist/exports/Text\";import StyleSheet from\"react-native-web/dist/exports/StyleSheet\";import TouchableOpacity from\"react-native-web/dist/exports/TouchableOpacity\";import ShowAvatar from\"../Avatar/ShowAvatar/showAvatar\";import ForwardSvg from\"../../assets/icons/forwardSvg\";import ForwardFocusSvg from\"../../assets/icons/forwardFocusSvg\";import{MessageContext}from\"../../context/MessageContext\";import AuthContext from\"../../context/AuthContext\";import useStyles from\"./messageBody.module\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var MessageBody=function MessageBody(_ref){var data=_ref.data,currentUser=_ref.currentUser;var imageUrl=data.imageUrl,nickname=data.nickname,role=data.role,message=data.message,own=data.own,channel=data.channel,date=data.date,unauth=data.unauth,ident=data.ident;var _useState=useState(false),_useState2=_slicedToArray(_useState,2),isFocused=_useState2[0],setIsFocused=_useState2[1];var dated=new Date(date);var time=dated.toLocaleTimeString([],{hour:'2-digit',minute:'2-digit'});var username='admin';var password='root';var _useContext=useContext(AuthContext),user=_useContext.user;var styles=useStyles();var forwardIcon=isFocused?_jsx(ForwardFocusSvg,{}):_jsx(ForwardSvg,{});var messageBoxStyles=[styles.messageBox,own?styles.ownMessageBox:styles.box,{borderTopRightRadius:own?10:10,borderBottomRightRadius:own?0:10,borderBottomLeftRadius:own?10:10,borderTopLeftRadius:own?10:0}];var handleForwardPress=function(){var _ref2=_asyncToGenerator(function*(){setIsFocused(function(prevIsFocused){return!prevIsFocused;});if(isFocused){var user_id=user.id;var message_id=ident;try{var response=yield fetch(\"https://linking-api.onrender.com/api/saved_message/delete?user_id=\"+user_id+\"&message_id=\"+message_id,{method:'DELETE',headers:{'Content-Type':'application/json','Authorization':\"Basic \"+btoa(username+\":\"+password)}});if(response.ok){}else{alert('Не удалось удалить сообщение');}}catch(error){console.log('Ошибка при удалении сообщения',error);}}else{var body={username:user.name,messageId:ident};try{var _response=yield fetch('https://linking-api.onrender.com/api/saved_message/save',{method:'POST',headers:{'Content-Type':'application/json','Authorization':\"Basic \"+btoa(username+\":\"+password)},body:JSON.stringify(body)});if(_response.ok){}else{alert('Не удалось сохранить сообщение');}}catch(error){console.log('Ошибка при сохранении сообщения',error);}}});return function handleForwardPress(){return _ref2.apply(this,arguments);};}();return _jsxs(View,{style:own?styles.ownContainer:styles.container,children:[!own&&imageUrl&&_jsx(View,{style:styles.avatar,children:_jsx(ShowAvatar,{imageUrl:imageUrl,profile:false})}),_jsxs(View,{style:messageBoxStyles,children:[!unauth&&_jsx(TouchableOpacity,{onPress:handleForwardPress,children:_jsx(View,{style:own?styles.ownForward:styles.forward,children:forwardIcon})}),_jsx(Text,{style:styles.nickname,children:nickname}),channel&&_jsx(Text,{style:styles.role,children:role}),_jsx(Text,{style:styles.message,children:message}),_jsx(Text,{style:own?styles.ownTime:styles.time,children:time}),own&&_jsx(View,{style:styles.ownBubbleTail}),!own&&_jsx(View,{style:styles.bubbleTail})]})]});};export default MessageBody;","map":{"version":3,"names":["React","useState","useContext","View","Text","StyleSheet","TouchableOpacity","ShowAvatar","ForwardSvg","ForwardFocusSvg","MessageContext","AuthContext","useStyles","jsx","_jsx","jsxs","_jsxs","MessageBody","_ref","data","currentUser","imageUrl","nickname","role","message","own","channel","date","unauth","ident","_useState","_useState2","_slicedToArray","isFocused","setIsFocused","dated","Date","time","toLocaleTimeString","hour","minute","username","password","_useContext","user","styles","forwardIcon","messageBoxStyles","messageBox","ownMessageBox","box","borderTopRightRadius","borderBottomRightRadius","borderBottomLeftRadius","borderTopLeftRadius","handleForwardPress","_ref2","_asyncToGenerator","prevIsFocused","user_id","id","message_id","response","fetch","method","headers","btoa","ok","alert","error","console","log","body","name","messageId","JSON","stringify","apply","arguments","style","ownContainer","container","children","avatar","profile","onPress","ownForward","forward","ownTime","ownBubbleTail","bubbleTail"],"sources":["C:/Users/ilias/OneDrive/Рабочий стол/messenger_project/Application/Client/components/messageBody/messageBody.js"],"sourcesContent":["import React, { useState, useContext } from 'react';\r\nimport { View, Text, StyleSheet, TouchableOpacity } from 'react-native-web';\r\nimport ShowAvatar from '../Avatar/ShowAvatar/showAvatar';\r\nimport ForwardSvg from '../../assets/icons/forwardSvg';\r\nimport ForwardFocusSvg from '../../assets/icons/forwardFocusSvg';\r\nimport { MessageContext } from '../../context/MessageContext';\r\nimport AuthContext from '../../context/AuthContext';\r\nimport useStyles from './messageBody.module';\r\n\r\nconst MessageBody = ({ data, currentUser }) => {\r\n  const { imageUrl, nickname, role, message, own, channel, date, unauth, ident  } = data;\r\n  const [isFocused, setIsFocused] = useState(false);\r\n  const dated = new Date(date);\r\n  const time = dated.toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });\r\n  const username = 'admin';\r\n  const password = 'root';\r\n  const {user} = useContext(AuthContext);\r\n  const styles = useStyles();\r\n  const forwardIcon = isFocused ? <ForwardFocusSvg /> : <ForwardSvg />;\r\n\r\n  const messageBoxStyles = [\r\n    styles.messageBox,\r\n    own ? styles.ownMessageBox : styles.box,\r\n    {\r\n      borderTopRightRadius: own ? 10 : 10,\r\n      borderBottomRightRadius: own ? 0 : 10,\r\n      borderBottomLeftRadius: own ? 10 : 10,\r\n      borderTopLeftRadius: own ? 10 : 0,\r\n    },\r\n  ];\r\n\r\n  const handleForwardPress = async () => {\r\n    setIsFocused((prevIsFocused) => !prevIsFocused);\r\n    if (isFocused) {\r\n      const user_id = user.id;\r\n      const message_id = ident;\r\n  \r\n      try {\r\n        const response = await fetch(`https://linking-api.onrender.com/api/saved_message/delete?user_id=${user_id}&message_id=${message_id}`, {\r\n          method: 'DELETE',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Basic ${btoa(`${username}:${password}`)}`\r\n          },\r\n        });\r\n  \r\n        if (response.ok) {\r\n         \r\n        } else {\r\n          alert('Не удалось удалить сообщение');\r\n        }\r\n      } catch (error) {\r\n        console.log('Ошибка при удалении сообщения', error);\r\n      }\r\n    } else {\r\n      const body = {\r\n        username: user.name,\r\n        messageId: ident\r\n      };\r\n  \r\n      try {\r\n        const response = await fetch('https://linking-api.onrender.com/api/saved_message/save', {\r\n          method: 'POST',\r\n          headers: {\r\n            'Content-Type': 'application/json',\r\n            'Authorization': `Basic ${btoa(`${username}:${password}`)}`,\r\n          },\r\n          body: JSON.stringify(body),\r\n        });\r\n  \r\n        if (response.ok) {\r\n          // Handle successful save\r\n        } else {\r\n          alert('Не удалось сохранить сообщение');\r\n        }\r\n      } catch (error) {\r\n        console.log('Ошибка при сохранении сообщения', error);\r\n      }\r\n    }\r\n  \r\n    \r\n  };\r\n  \r\n\r\n  return (\r\n    <View style={own ? styles.ownContainer : styles.container}>\r\n      {!own && imageUrl && (\r\n        <View style={styles.avatar}>\r\n          <ShowAvatar imageUrl={imageUrl} profile={false} />\r\n        </View>\r\n      )}\r\n      <View style={messageBoxStyles}>\r\n        {!unauth && (\r\n          <TouchableOpacity onPress={handleForwardPress}>\r\n            <View style={own ? styles.ownForward : styles.forward}>{forwardIcon}</View>\r\n          </TouchableOpacity>\r\n        )}\r\n        <Text style={styles.nickname}>{nickname}</Text>\r\n        {channel && <Text style={styles.role}>{role}</Text>}\r\n        <Text style={styles.message}>{message}</Text>\r\n        <Text style={own ? styles.ownTime : styles.time}>{time}</Text>\r\n        {own && <View style={styles.ownBubbleTail} />}\r\n        {!own && <View style={styles.bubbleTail} />}\r\n      </View>\r\n    </View>\r\n  );\r\n};\r\n\r\n\r\n\r\nexport default MessageBody;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}